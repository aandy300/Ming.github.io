"use strict";(self["webpackChunkweek6"]=self["webpackChunkweek6"]||[]).push([[757],{5757:function(e,t,o){o.r(t),o.d(t,{default:function(){return je}});var l=o(3396),s=o(7139);const d={class:"container-fluid mt-3 position-relative"},r={class:"table mt-4"},a=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"購買時間"),(0,l._)("th",null,"Email"),(0,l._)("th",null,"購買款項"),(0,l._)("th",null,"應付金額"),(0,l._)("th",null,"是否付款"),(0,l._)("th",null,"編輯")])],-1),n=(0,l._)("tbody",null,null,-1),i={id:"productList"},c={width:"120"},u={width:"120"},p={width:"120"},h={width:"100"},m={width:"100"},_={key:0,class:"text-success"},w={key:1,class:"text-danger"},b={width:"120"},g={class:"btn-group"},k=["onClick"],T=["onClick"];function v(e,t,o,v,y,f){const $=(0,l.up)("ObjOrdersEditModal"),D=(0,l.up)("ObjOrdersDelModal"),x=(0,l.up)("ObjPagination");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",d,[(0,l._)("table",r,[a,n,(0,l._)("tbody",i,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(y.orders,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id},[(0,l._)("td",c,(0,s.zw)(new Date(1e3*e.create_at).toISOString().split("T").toString().slice(0,-5).replace(",","-")),1),(0,l._)("td",u,(0,s.zw)(e.user.email),1),(0,l._)("td",p,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.products,(e=>((0,l.wg)(),(0,l.iD)("div",{key:e.id,width:"100"},[(0,l._)("td",null,(0,s.zw)(e.product.title),1)])))),128))]),(0,l._)("td",h," $ "+(0,s.zw)(e.total),1),(0,l._)("td",m,[e.is_paid?((0,l.wg)(),(0,l.iD)("span",_,"已付款")):((0,l.wg)(),(0,l.iD)("span",w,"尚未付款"))]),(0,l._)("td",b,[(0,l._)("div",g,[(0,l._)("button",{onClick:t=>f.openModal("edit",e),type:"button",class:"btn btn-outline-primary btn-sm"}," 編輯 ",8,k),(0,l._)("button",{onClick:t=>f.openModal("del",e),type:"button",class:"btn btn-outline-danger btn-sm"}," 刪除 ",8,T)])])])))),128))])])]),(0,l.Wm)($,{orderTemp:y.orderTemp,ref:"orderEditMoadl",onResetorderlist:f.getOrders},null,8,["orderTemp","onResetorderlist"]),(0,l.Wm)(D,{orderTemp:y.orderTemp,ref:"orderDelMoadl",onResetorderlist:f.getOrders},null,8,["orderTemp","onResetorderlist"]),(0,l.Wm)(x,{pages:y.pagination,onGetData:f.getOrders},null,8,["pages","onGetData"])],64)}var y=o(9242);const f={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},$={class:"modal-dialog modal-xl",role:"document"},D={class:"modal-content border-0"},x=(0,l._)("div",{class:"modal-header bg-dark text-white"},[(0,l._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,l._)("span",null,"訂單細節")]),(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),M={class:"modal-body"},O={class:"row"},z={class:"col-md-4"},C=(0,l._)("h3",null,"用戶資料",-1),L={class:"table"},j={key:0},E=(0,l._)("th",{style:{width:"100px"}},"姓名",-1),H=(0,l._)("th",null,"Email",-1),P=(0,l._)("th",null,"電話",-1),R=(0,l._)("th",null,"地址",-1),Y={class:"col-md-8"},Z=(0,l._)("h3",null,"訂單細節",-1),K={class:"table"},S=(0,l._)("th",{style:{width:"100px"}},"訂單編號",-1),U=(0,l._)("th",null,"下單時間",-1),W=(0,l._)("th",null,"付款時間",-1),q={key:0},A={key:1},G=(0,l._)("th",null,"付款狀態",-1),I={key:0,class:"text-success"},V={key:1,class:"text-muted"},B=(0,l._)("th",null,"總金額",-1),F=(0,l._)("h3",null,"選購商品",-1),J={class:"table"},N=(0,l._)("thead",null,[(0,l._)("tr")],-1),Q={class:"text-end"},X={class:"d-flex justify-content-end"},ee={class:"form-check"},te={class:"form-check-label",for:"flexCheckDefault"},oe={key:0},le={key:1},se={class:"modal-footer"},de=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function re(e,t,o,d,r,a){return(0,l.wg)(),(0,l.iD)("div",f,[(0,l._)("div",$,[(0,l._)("div",D,[x,(0,l._)("div",M,[(0,l._)("div",O,[(0,l._)("div",z,[C,(0,l._)("table",L,[r.neworderTemp.user?((0,l.wg)(),(0,l.iD)("tbody",j,[(0,l._)("tr",null,[E,(0,l._)("td",null,(0,s.zw)(r.neworderTemp.user.name),1)]),(0,l._)("tr",null,[H,(0,l._)("td",null,(0,s.zw)(r.neworderTemp.user.email),1)]),(0,l._)("tr",null,[P,(0,l._)("td",null,(0,s.zw)(r.neworderTemp.user.tel),1)]),(0,l._)("tr",null,[R,(0,l._)("td",null,(0,s.zw)(r.neworderTemp.user.address),1)])])):(0,l.kq)("",!0)])]),(0,l._)("div",Y,[Z,(0,l._)("table",K,[(0,l._)("tbody",null,[(0,l._)("tr",null,[S,(0,l._)("td",null,(0,s.zw)(r.neworderTemp.id),1)]),(0,l._)("tr",null,[U,(0,l._)("td",null,(0,s.zw)(r.neworderTemp.create_at),1)]),(0,l._)("tr",null,[W,(0,l._)("td",null,[r.neworderTemp.paid_date?((0,l.wg)(),(0,l.iD)("span",q)):((0,l.wg)(),(0,l.iD)("span",A,"時間不正確"))])]),(0,l._)("tr",null,[G,(0,l._)("td",null,[r.neworderTemp.is_paid?((0,l.wg)(),(0,l.iD)("strong",I,"已付款")):((0,l.wg)(),(0,l.iD)("span",V,"尚未付款"))])]),(0,l._)("tr",null,[B,(0,l._)("td",null,(0,s.zw)(r.neworderTemp.total),1)])])]),F,(0,l._)("table",J,[N,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(r.neworderTemp.products,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id},[(0,l._)("th",null,(0,s.zw)(e.product.title),1),(0,l._)("td",null,(0,s.zw)(e.qty)+" / "+(0,s.zw)(e.product.unit),1),(0,l._)("td",Q,(0,s.zw)(e.final_total),1)])))),128))])]),(0,l._)("div",X,[(0,l._)("div",ee,[(0,l.wy)((0,l._)("input",{class:"form-check-input",type:"checkbox",value:"",id:"flexCheckDefault","onUpdate:modelValue":t[0]||(t[0]=e=>r.neworderTemp.is_paid=e)},null,512),[[y.e8,r.neworderTemp.is_paid]]),(0,l._)("label",te,[r.neworderTemp.is_paid?((0,l.wg)(),(0,l.iD)("span",oe,"已付款")):((0,l.wg)(),(0,l.iD)("span",le,"未付款"))])])])])])]),(0,l._)("div",se,[de,(0,l._)("button",{type:"button",class:"btn btn-primary",onClick:t[1]||(t[1]=e=>a.updatePaid(r.neworderTemp))}," 修改付款狀態 ")])])])],512)}var ae=o(7972),ne=o.n(ae),ie={data(){return{neworderTemp:{}}},methods:{checkLogin(){const e=document.cookie.replace(/(?:(?:^|.*;\s*)mingToken\s*\=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common["Authorization"]=e,this.$http.post("https://vue3-course-api.hexschool.io/v2/api/user/check").then((e=>{console.log("checkLogin()","確認登入成功",e)})).catch((e=>{console.dir(e),this.$router.push("/admin/login")}))},openModal(){this.modal.show()},closeModal(){this.modal.hide()},updatePaid(e){const t={is_paid:e.is_paid};this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/ming123/admin/order/${e.id}`,{data:t}).then((e=>{this.closeModal(),this.$emit("resetorderlist"),console.log(e,e.status,"成功更新")})).catch((e=>{console.dir(e.response,"錯誤訊息"),console.log(e.response.data.message)}))},delOrder(e){this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/ming123/admin/order/${e.id}`).then((t=>{this.closeModal(),this.$emit("resetorderlist"),console.log(t,t.status,"已刪除:",e.id,"該筆訂單")})).catch((e=>{console.dir(e.response,"錯誤訊息"),console.log(e.response.data.message)}))}},props:["orderTemp"],emits:["resetorderlist"],watch:{orderTemp(){this.neworderTemp=this.orderTemp}},created(){this.neworderTemp=this.orderTemp},mounted(){this.modal=new(ne())(this.$refs.modal),this.checkLogin()}},ce=o(89);const ue=(0,ce.Z)(ie,[["render",re]]);var pe=ue;const he={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},me={class:"modal-dialog",role:"document"},_e={class:"modal-content border-0"},we={class:"modal-header bg-danger text-white"},be={class:"modal-title"},ge=(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),ke={class:"modal-body"},Te=(0,l.Uk)(" 是否刪除 "),ve={class:"text-danger"},ye=(0,l.Uk)(" 該筆訂單 (刪除後將無法恢復)。 "),fe={class:"modal-footer"},$e=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1);function De(e,t,o,d,r,a){return(0,l.wg)(),(0,l.iD)("div",he,[(0,l._)("div",me,[(0,l._)("div",_e,[(0,l._)("div",we,[(0,l._)("h5",be,[(0,l._)("span",null,"刪除 "+(0,s.zw)(r.neworderTemp.id),1)]),ge]),(0,l._)("div",ke,[Te,(0,l._)("strong",ve,(0,s.zw)(r.neworderTemp.id),1),ye]),(0,l._)("div",fe,[$e,(0,l._)("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=e=>a.delOrder(r.neworderTemp))},"確認刪除")])])])],512)}var xe={data(){return{neworderTemp:{}}},methods:{checkLogin(){const e=document.cookie.replace(/(?:(?:^|.*;\s*)mingToken\s*\=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common["Authorization"]=e,this.$http.post("https://vue3-course-api.hexschool.io/v2/api/user/check").then((e=>{console.log("checkLogin()","確認登入成功",e)})).catch((e=>{console.dir(e),this.$router.push("/admin/login")}))},delOrder(e){this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/ming123/admin/order/${e.id}`).then((t=>{this.closeModal(),this.$emit("resetorderlist"),console.log(t,t.status,"已刪除:",e.id,"該筆訂單")})).catch((e=>{console.dir(e.response,"錯誤訊息"),console.log(e.response.data.message)}))},openModal(){this.modal.show()},closeModal(){this.modal.hide()}},props:["orderTemp"],emits:["resetorderlist"],watch:{orderTemp(){this.neworderTemp=this.orderTemp}},created(){this.neworderTemp=this.orderTemp},mounted(){this.modal=new(ne())(this.$refs.modal),this.checkLogin()}};const Me=(0,ce.Z)(xe,[["render",De]]);var Oe=Me,ze=o(9230),Ce={data(){return{orders:[],orderTemp:{},pagination:""}},components:{ObjOrdersEditModal:pe,ObjOrdersDelModal:Oe,ObjPagination:ze.Z},methods:{getOrders(e=1){console.log("getOrders()"),this.$http(`https://vue3-course-api.hexschool.io/v2/api/ming123/orders?page=${e}`).then((e=>{this.orders=e.data.orders,this.pagination=e.data.pagination})).catch((e=>{console.log(e),console.dir(e)}))},openModal(e,t){if(this.orderTemp={...t},"edit"===e){const e=this.$refs.orderEditMoadl;e.openModal()}else if("del"===e){console.log(this.$refs);const e=this.$refs.orderDelMoadl;e.openModal()}}},mounted(){this.getOrders()}};const Le=(0,ce.Z)(Ce,[["render",v]]);var je=Le}}]);
//# sourceMappingURL=757.b1b88e64.js.map