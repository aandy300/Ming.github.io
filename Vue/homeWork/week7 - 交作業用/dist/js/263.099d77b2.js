"use strict";(self["webpackChunkweek6"]=self["webpackChunkweek6"]||[]).push([[263],{5263:function(e,t,a){a.r(t),a.d(t,{default:function(){return He}});var l=a(3396),o=a(7139);const s={class:"container"},n={class:"text-end mt-4"},d={class:"table mt-4"},i=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th",null,"產品名稱"),(0,l._)("th",{width:"120"}," 原價 "),(0,l._)("th",{width:"120"}," 售價 "),(0,l._)("th",{width:"150"}," 是否啟用 "),(0,l._)("th",{width:"120"}," 查看細項 "),(0,l._)("th",{width:"120"}," 刪除 ")])],-1),c={id:"productList"},r={width:"120"},m={width:"120"},p={width:"100"},u={key:0,class:"text-success"},h={key:1,class:"text-danger"},b=(0,l.Uk)("詳細資訊"),w={width:"120"},g={class:"btn-group"},_=["onClick"],f=["onClick"],y=(0,l.Uk)("目前顯示 "),v={id:"productCount"},k=(0,l.Uk)(" 項產品");function D(e,t,a,D,M,T){const U=(0,l.up)("router-link"),x=(0,l.up)("ObjPagination"),$=(0,l.up)("ObjEditNewItemButtonModal"),P=(0,l.up)("ObjDelButtonModal");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",s,[(0,l._)("div",n,[(0,l._)("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=e=>(T.openModal("new"),M.isNew=!0))}," 建立新的產品 ")]),(0,l._)("table",d,[i,(0,l._)("tbody",c,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(M.products,((e,t)=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id},[(0,l._)("td",null,(0,o.zw)(e.title),1),(0,l._)("td",r,(0,o.zw)(e.origin_price),1),(0,l._)("td",m,(0,o.zw)(e.price),1),(0,l._)("td",p,[M.products[t].is_enabled?((0,l.wg)(),(0,l.iD)("span",u,"啟用")):((0,l.wg)(),(0,l.iD)("span",h,"未啟用"))]),(0,l._)("td",null,[(0,l.Wm)(U,{class:"btn btn-primary",to:`/product/${e.id}`},{default:(0,l.w5)((()=>[b])),_:2},1032,["to"])]),(0,l._)("td",w,[(0,l._)("div",g,[(0,l._)("button",{onClick:t=>(T.openModal("edit",e),M.isNew=!1,T.checkInfo(e)),type:"button",class:"btn btn-outline-primary btn-sm"}," 編輯 ",8,_),(0,l._)("button",{onClick:t=>(T.openModal("del",e),T.checkInfo(e)),type:"button",class:"btn btn-outline-danger btn-sm"}," 刪除 ",8,f)])])])))),128))])]),(0,l._)("p",null,[y,(0,l._)("span",v,(0,o.zw)(M.products.length),1),k]),(0,l.Wm)(x,{pages:M.pagination,onGetData:T.getData},null,8,["pages","onGetData"])]),(0,l.Wm)($,{temp:M.temp,"is-new":M.isNew,ref:"productModal",onEditProduct:T.editProduct,onAddProductPost:T.addProductPost},null,8,["temp","is-new","onEditProduct","onAddProductPost"]),(0,l.Wm)(P,{temp:M.temp,ref:"delModal",onCloseModal:T.closeModal,onDelData:T.delData},null,8,["temp","onCloseModal","onDelData"])],64)}var M=a(9230);const T={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},U={class:"modal-dialog",role:"document"},x={class:"modal-content border-0"},$={class:"modal-header bg-danger text-white"},P={class:"modal-title"},N=(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),C={class:"modal-body"},V=(0,l.Uk)(" 是否刪除 "),I={class:"text-danger"},z=(0,l.Uk)(" (刪除後將無法恢復)。 "),L={class:"modal-footer"},j=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1);function O(e,t,a,s,n,d){return(0,l.wg)(),(0,l.iD)("div",T,[(0,l._)("div",U,[(0,l._)("div",x,[(0,l._)("div",$,[(0,l._)("h5",P,[(0,l._)("span",null,"刪除 "+(0,o.zw)(n.newTemp.data.title),1)]),N]),(0,l._)("div",C,[V,(0,l._)("strong",I,(0,o.zw)(n.newTemp.data.title),1),z]),(0,l._)("div",L,[j,(0,l._)("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=t=>(e.$emit("delData"),d.closeModal()))},"確認刪除")])])])],512)}var A=a(7972),B=a.n(A),E={data(){return{newTemp:""}},props:["temp"],methods:{openModal(){this.modal.show()},closeModal(){this.modal.hide()}},created(){this.newTemp=this.temp},mounted(){this.modal=new(B())(this.$refs.modal)}},W=a(89);const Z=(0,W.Z)(E,[["render",O]]);var H=Z,Y=a(9242);const G={id:"productModal",ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},K={class:"modal-dialog modal-xl"},q={class:"modal-content border-0"},F={class:"modal-header bg-dark text-white"},J={id:"productModalLabel",class:"modal-title"},Q={key:0},R={key:1},S=(0,l._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),X={class:"modal-body"},ee={class:"row"},te={class:"col-sm-4"},ae={class:"mb-3"},le=(0,l._)("label",{for:"imageUrl",class:"form-label"},"主要圖片",-1),oe=["src"],se=(0,l._)("h3",{class:"mb-3"},"多圖新增",-1),ne={key:0},de={class:"mb-3"},ie=(0,l._)("label",{for:"imageUrl",class:"form-label"},"圖片網址",-1),ce=["onUpdate:modelValue"],re=["src"],me={key:0},pe={key:1},ue={key:1},he={class:"col-sm-8"},be={class:"mb-3"},we=(0,l._)("label",{for:"title",class:"form-label"},"標題",-1),ge={class:"row"},_e={class:"mb-3 col-md-6"},fe=(0,l._)("label",{for:"category",class:"form-label"},"分類",-1),ye={class:"mb-3 col-md-6"},ve=(0,l._)("label",{for:"price",class:"form-label"},"單位",-1),ke={class:"row"},De={class:"mb-3 col-md-6"},Me=(0,l._)("label",{for:"origin_price",class:"form-label"},"原價",-1),Te={class:"mb-3 col-md-6"},Ue=(0,l._)("label",{for:"price",class:"form-label"},"售價",-1),xe=(0,l._)("hr",null,null,-1),$e={class:"mb-3"},Pe=(0,l._)("label",{for:"description",class:"form-label"},"產品描述",-1),Ne={class:"mb-3"},Ce=(0,l._)("label",{for:"content",class:"form-label"},"說明內容",-1),Ve={class:"mb-3"},Ie={class:"form-check"},ze=(0,l._)("label",{class:"form-check-label",for:"is_enabled"},"是否啟用",-1),Le={class:"modal-footer"},je=(0,l._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Oe(e,t,a,o,s,n){return(0,l.wg)(),(0,l.iD)("div",G,[(0,l._)("div",K,[(0,l._)("div",q,[(0,l._)("div",F,[(0,l._)("h5",J,[s.inside_isNew?((0,l.wg)(),(0,l.iD)("span",Q,"新增產品")):((0,l.wg)(),(0,l.iD)("span",R,"編輯產品"))]),S]),(0,l._)("div",X,[(0,l._)("div",ee,[(0,l._)("div",te,[(0,l._)("div",ae,[le,(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>s.newTemp.data.imageUrl=e),type:"text",class:"form-control mb-2",placeholder:"請輸入圖片連結"},null,512),[[Y.nr,s.newTemp.data.imageUrl]]),(0,l._)("img",{class:"img-fluid",src:s.newTemp.data.imageUrl},null,8,oe)]),se,Array.isArray(s.newTemp.data.imagesUrl)?((0,l.wg)(),(0,l.iD)("div",ne,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(s.newTemp.data.imagesUrl,((e,t)=>((0,l.wg)(),(0,l.iD)("div",{class:"mb-1",key:t},[(0,l._)("div",de,[ie,(0,l.wy)((0,l._)("input",{"onUpdate:modelValue":e=>s.newTemp.data.imagesUrl[t]=e,type:"text",class:"form-control",placeholder:"請輸入圖片連結"},null,8,ce),[[Y.nr,s.newTemp.data.imagesUrl[t]]])]),(0,l._)("img",{class:"img-fluid",src:e},null,8,re)])))),128)),!s.newTemp.data.imagesUrl.length||s.newTemp.data.imagesUrl[s.newTemp.data.imagesUrl.length-1]?((0,l.wg)(),(0,l.iD)("div",me,[(0,l._)("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:t[1]||(t[1]=e=>s.newTemp.data.imagesUrl.push(""))}," 新增圖片 ")])):((0,l.wg)(),(0,l.iD)("div",pe,[(0,l._)("button",{class:"btn btn-outline-danger btn-sm d-block w-100",onClick:t[2]||(t[2]=e=>s.newTemp.data.imagesUrl.pop())}," 刪除圖片 ")]))])):((0,l.wg)(),(0,l.iD)("div",ue,[(0,l._)("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:t[3]||(t[3]=t=>e.$emit("createImages"))}," 新增圖片 ")]))]),(0,l._)("div",he,[(0,l._)("div",be,[we,(0,l.wy)((0,l._)("input",{id:"title","onUpdate:modelValue":t[4]||(t[4]=e=>s.newTemp.data.title=e),type:"text",class:"form-control",placeholder:"請輸入標題"},null,512),[[Y.nr,s.newTemp.data.title]])]),(0,l._)("div",ge,[(0,l._)("div",_e,[fe,(0,l.wy)((0,l._)("input",{id:"category","onUpdate:modelValue":t[5]||(t[5]=e=>s.newTemp.data.category=e),type:"text",class:"form-control",placeholder:"請輸入分類"},null,512),[[Y.nr,s.newTemp.data.category]])]),(0,l._)("div",ye,[ve,(0,l.wy)((0,l._)("input",{id:"unit","onUpdate:modelValue":t[6]||(t[6]=e=>s.newTemp.data.unit=e),type:"text",class:"form-control",placeholder:"請輸入單位"},null,512),[[Y.nr,s.newTemp.data.unit]])])]),(0,l._)("div",ke,[(0,l._)("div",De,[Me,(0,l.wy)((0,l._)("input",{id:"origin_price","onUpdate:modelValue":t[7]||(t[7]=e=>s.newTemp.data.origin_price=e),type:"number",min:"0",class:"form-control",placeholder:"請輸入原價"},null,512),[[Y.nr,s.newTemp.data.origin_price,void 0,{number:!0}]])]),(0,l._)("div",Te,[Ue,(0,l.wy)((0,l._)("input",{id:"price","onUpdate:modelValue":t[8]||(t[8]=e=>s.newTemp.data.price=e),type:"number",min:"0",class:"form-control",placeholder:"請輸入售價"},null,512),[[Y.nr,s.newTemp.data.price,void 0,{number:!0}]])])]),xe,(0,l._)("div",$e,[Pe,(0,l.wy)((0,l._)("textarea",{id:"description","onUpdate:modelValue":t[9]||(t[9]=e=>s.newTemp.data.description=e),type:"text",class:"form-control",placeholder:"請輸入產品描述"},"\r\n                  ",512),[[Y.nr,s.newTemp.data.description]])]),(0,l._)("div",Ne,[Ce,(0,l.wy)((0,l._)("textarea",{id:"description","onUpdate:modelValue":t[10]||(t[10]=e=>s.newTemp.data.content=e),type:"text",class:"form-control",placeholder:"請輸入說明內容"},"\r\n                  ",512),[[Y.nr,s.newTemp.data.content]])]),(0,l._)("div",Ve,[(0,l._)("div",Ie,[(0,l.wy)((0,l._)("input",{id:"is_enabled","onUpdate:modelValue":t[11]||(t[11]=e=>s.newTemp.data.is_enabled=e),class:"form-check-input",type:"checkbox","true-value":1,"false-value":0},null,512),[[Y.e8,s.newTemp.data.is_enabled]]),ze])])])])]),(0,l._)("div",Le,[je,(s.inside_isNew=s.inside_isNew)?((0,l.wg)(),(0,l.iD)("button",{key:0,type:"button",class:"btn btn-primary",onClick:t[12]||(t[12]=t=>(e.$emit("addProductPost"),n.closeModal()))},"確認新增")):((0,l.wg)(),(0,l.iD)("button",{key:1,type:"button",class:"btn btn-primary",onClick:t[13]||(t[13]=t=>e.$emit("editProduct",n.closeModal()))},"確認修改"))])])])],512)}var Ae={data(){return{newTemp:"",inside_isNew:!1}},props:["temp","isNew"],watch:{temp(){this.newTemp=this.temp},isNew(){this.inside_isNew=this.isNew}},methods:{openModal(){this.modal.show(),console.log("isNew:",this.isNew,"inside_New:",this.inside_isNew)},closeModal(){this.modal.hide()}},created(){this.newTemp=this.temp},mounted(){this.modal=new(B())(this.$refs.modal)}};const Be=(0,W.Z)(Ae,[["render",Oe]]);var Ee=Be,We={data(){return{nowInfo:{},products:{},pagination:"",temp:{data:{}},isNew:!1}},components:{ObjPagination:M.Z,ObjDelButtonModal:H,ObjEditNewItemButtonModal:Ee},methods:{checkInfo(e){this.nowInfo={},this.nowInfo=e},checkLogin(){const e=document.cookie.replace(/(?:(?:^|.*;\s*)mingToken\s*\=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common["Authorization"]=e,this.$http.post("https://vue3-course-api.hexschool.io/v2/api/user/check").then((e=>{console.log("checkLogin()","確認登入成功",e)})).catch((e=>{console.dir(e),this.$router.push("/admin/login")}))},getData(e=1){this.$http.get(`https://vue3-course-api.hexschool.io/v2/api/ming123/admin/products/?page=${e}`).then((e=>{console.log("getData()",e),this.nowInfo={},this.products=e.data.products,this.pagination=e.data.pagination})).catch((e=>{console.dir(e)}))},addProductPost(){console.log("addProductPost"),this.$http.post("https://vue3-course-api.hexschool.io/v2/api/ming123/admin/product",this.temp).then((e=>{console.dir("新增商品成功"),this.getData(),this.isNew=!1})).catch((e=>{alert(e.status+" 請正確填寫商品資訊")}))},delData(){console.log("delData..."),this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/ming123/admin/product/${this.temp.data.id}`).then((e=>{this.temp.data={imagesUrl:[]},this.getData(),console.log(` ${this.temp.data.id} 已刪除此id商品`)})).catch((e=>{alert(e.data.message)}))},editProduct(){console.log(this.temp),console.log("editProduct"),this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/ming123/admin/product/${this.temp.data.id}`,this.temp).then((e=>{this.getData(),console.log(e.status+" 成功修改商品")})).catch((e=>{alert(e.data.message)}))},openModal(e,t){if(this.temp.data={...t},"edit"===e){console.log("openModal-edit");const e=this.$refs.productModal;e.openModal()}else if("del"===e){console.log(this.$refs);const e=this.$refs.delModal;e.openModal()}else if("new"===e){this.temp.data={},this.temp.data={imagesUrl:[]},console.log("openModal-new");const e=this.$refs.productModal;e.openModal()}},closeModal(e){"del"===e?console.log("mydelModal.hide()"):console.log("mydelModal.hide() else")}},mounted(){this.checkLogin(),this.getData()}};const Ze=(0,W.Z)(We,[["render",D]]);var He=Ze}}]);
//# sourceMappingURL=263.099d77b2.js.map