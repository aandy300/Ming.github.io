"use strict";(self["webpackChunkweek9"]=self["webpackChunkweek9"]||[]).push([[158],{4158:function(e,t,a){a.r(t),a.d(t,{default:function(){return ae}});var l=a(3396),s=a(7139),r=a(9242);const o={key:0,class:"container"},i={key:0,class:"d-flex justify-content-center my-5"},c={class:"col-md-6 card text-center",style:{}},d={class:"card-body"},n=(0,l._)("strong",null,[(0,l._)("p",{class:"m-0 text-primary",style:{"font-size":"2rem"}},"購物車目前沒有東西哦")],-1),m=(0,l._)("button",{class:"col-4 btn btn-outline-primary mt-2",type:"button"},"前去購買",-1),u={key:1,class:"row d-flex flex-nowrap justify-content-center align-items-center"},p=(0,l.uE)('<div style="max-width:18rem;" class="col-3 d-none d-sm-block card text-white bg-secondary my-5 mx-4 rounded"><div class="d-flex flex-column flex-nowrap justify-content-center align-items-center"><i class="bi bi-check2-circle mt-2" style="font-size:40px;"></i><p class="card-text text-center m-0">Step1</p><p class="card-text text-center mb-2">確認訂單</p></div></div><div style="max-width:18rem;" class="col-3 d-none d-sm-block card text-balck bg-info my-5 mx-4 rounded"><div class="d-flex flex-column flex-nowrap justify-content-center align-items-center"><i class="bi bi-dash-circle-dotted mt-2" style="font-size:40px;"></i><p class="card-text text-center m-0">Step2</p><p class="card-text text-center mb-2">建立訂單</p></div></div><div style="max-width:18rem;" class="col-3 d-none d-sm-block card text-balck bg-info my-5 mx-4 rounded"><div class="d-flex flex-column flex-nowrap justify-content-center align-items-center"><i class="bi bi-dash-circle-dotted mt-2" style="font-size:40px;"></i><p class="card-text text-center m-0">Step3</p><p class="card-text text-center mb-2">付款</p></div></div><div style="max-width:18rem;" class="col-10 d-flex align-items-center d-block d-sm-none card text-balck bg-info my-5 mx-4 rounded"><i class="bi bi-dash-circle-dotted mt-2" style="font-size:40px;"></i><p class="card-text text-center m-0">Step2</p><p class="card-text text-center mb-2">建立訂單</p></div>',4),h=[p],b={class:"row"},f={class:"col-xl-6"},g={class:"d-flex justify-content-between mb-2"},x=(0,l._)("h4",null,"訂單內容",-1),v={class:"text-end"},_={class:"table align-middle"},y=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th"),(0,l._)("th",{class:"d-none d-sm-block"},"圖片"),(0,l._)("th",null,"品名"),(0,l._)("th",{style:{width:"150px"}},"數量/單位"),(0,l._)("th",null,"單價")])],-1),k=["onClick","disabled"],w={class:"d-none d-sm-block"},C=["src"],I={class:"input-group input-group-sm"},D={class:"input-group mb-3"},V=["onUpdate:modelValue","onChange","disabled"],$=["value"],z={class:"input-group-text mt-3",id:"basic-addon2"},W={class:"text-end"},j=(0,l._)("td",null,null,-1),q=(0,l._)("td",{colspan:"3",class:"text-end fs-3"},"總計",-1),U={class:"text-end fs-3"},L=(0,l._)("tr",null,null,-1),S={class:"col-xl-6"},Z=(0,l._)("h4",{class:"ms-3 d-none d-xl-block"},"收件人資訊",-1),A=(0,l._)("h4",{class:"d-xl-none"},"收件人資訊",-1),O={class:"my-3 row justify-content-center"},E={class:"mb-3"},H=(0,l._)("label",{for:"email",class:"form-label"},"Email",-1),K={class:"mb-3"},P=(0,l._)("label",{for:"name",class:"form-label"},"收件人姓名",-1),Y={class:"mb-3"},F=(0,l._)("label",{for:"tel",class:"form-label"},"收件人電話",-1),M={class:"mb-3"},B=(0,l._)("label",{for:"address",class:"form-label"},"收件人地址",-1),G={class:"mb-3"},J=(0,l._)("label",{for:"message",class:"form-label"},"留言",-1),N={class:"text-end"},Q=["disabled"];function R(e,t,a,p,R,T){const X=(0,l.up)("router-link"),ee=(0,l.up)("v-field"),te=(0,l.up)("error-message"),ae=(0,l.up)("v-form");return!0===R.ready?((0,l.wg)(),(0,l.iD)("div",o,[0===R.cartData.carts.length?((0,l.wg)(),(0,l.iD)("div",i,[(0,l._)("div",c,[(0,l._)("div",d,[n,(0,l.Wm)(X,{to:"/products"},{default:(0,l.w5)((()=>[m])),_:1})])])])):((0,l.wg)(),(0,l.iD)("div",u,h)),(0,l._)("div",b,[(0,l._)("div",f,[(0,l._)("div",g,[x,(0,l._)("div",v,[(0,l._)("button",{onClick:t[0]||(t[0]=(...e)=>T.removeAllCartItem&&T.removeAllCartItem(...e)),class:(0,s.C_)([{disabled:0===R.cartData.carts.length},"btn btn-outline-primary"]),type:"button"},"清空購物車",2)])]),(0,l._)("table",_,[y,(0,l._)("tbody",null,[R.cartData.carts?((0,l.wg)(!0),(0,l.iD)(l.HY,{key:0},(0,l.Ko)(R.cartData.carts,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id},[(0,l._)("td",null,[(0,l._)("button",{onClick:t=>T.removeCartItem(e.id),disabled:R.isLoadingItem===e.id,type:"button",class:"btn btn-outline-danger btn-sm px-2 py-1"}," x ",8,k)]),(0,l._)("td",w,[(0,l._)("img",{style:{height:"100px"},class:"img-fluid",src:e.product.imageUrl,alt:""},null,8,C)]),(0,l._)("td",null,(0,s.zw)(e.product.title),1),(0,l._)("td",null,[(0,l._)("div",I,[(0,l._)("div",D,[(0,l.wy)((0,l._)("select",{id:"",class:"form-select mt-3","onUpdate:modelValue":t=>e.qty=t,onChange:t=>T.updataCartItem(e),disabled:R.isLoadingItem===e.id},[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)(20,(t=>(0,l._)("option",{value:t,key:`${t} + ${e.id}`},(0,s.zw)(t),9,$))),64))],40,V),[[r.bM,e.qty]]),(0,l._)("span",z,(0,s.zw)(e.product.unit),1)])])]),(0,l._)("td",W,(0,s.zw)(e.total),1)])))),128)):(0,l.kq)("",!0)]),(0,l._)("tfoot",null,[(0,l._)("tr",null,[j,q,(0,l._)("td",U,(0,s.zw)(R.cartData.total),1)]),L])])]),(0,l._)("div",S,[Z,A,(0,l._)("div",O,[(0,l.Wm)(ae,{onSubmit:T.createOrder,ref:"form",class:"col-md-9"},{default:(0,l.w5)((({errors:e})=>[(0,l._)("div",E,[H,(0,l.Wm)(ee,{modelValue:R.form.user.email,"onUpdate:modelValue":t[1]||(t[1]=e=>R.form.user.email=e),id:"email",name:"email",type:"email",class:(0,s.C_)(["form-control",{"is-invalid":e["email"]}]),placeholder:"請輸入 Email",rules:"email"},null,8,["modelValue","class"]),(0,l.Wm)(te,{name:"email",class:"invalid-feedback"})]),(0,l._)("div",K,[P,(0,l.Wm)(ee,{modelValue:R.form.user.name,"onUpdate:modelValue":t[2]||(t[2]=e=>R.form.user.name=e),id:"name",name:"姓名",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":e["姓名"]}]),placeholder:"請輸入姓名",rules:"required"},null,8,["modelValue","class"]),(0,l.Wm)(te,{name:"姓名",class:"invalid-feedback"})]),(0,l._)("div",Y,[F,(0,l.Wm)(ee,{modelValue:R.form.user.tel,"onUpdate:modelValue":t[3]||(t[3]=e=>R.form.user.tel=e),id:"tel",name:"電話",type:"number",class:(0,s.C_)(["form-control",{"is-invalid":e["電話"]}]),placeholder:"請輸入電話",rules:T.isPhone},null,8,["modelValue","class","rules"]),(0,l.Wm)(te,{name:"電話",class:"invalid-feedback"})]),(0,l._)("div",M,[B,(0,l.Wm)(ee,{modelValue:R.form.user.address,"onUpdate:modelValue":t[4]||(t[4]=e=>R.form.user.address=e),id:"address",name:"地址",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":e["地址"]}]),placeholder:"請輸入地址",rules:"required"},null,8,["modelValue","class"]),(0,l.Wm)(te,{name:"地址",class:"invalid-feedback"})]),(0,l._)("div",G,[J,(0,l.wy)((0,l._)("textarea",{"onUpdate:modelValue":t[5]||(t[5]=e=>R.form.message=e),id:"message",class:"form-control",cols:"30",rows:"10"},null,512),[[r.nr,R.form.message]])]),(0,l._)("div",N,[(0,l._)("button",{type:"submit",class:"col-12 btn btn-primary",disabled:Object.keys(e).length>0||0===R.cartData.carts.length},"送出訂單",8,Q)])])),_:1},8,["onSubmit"])])])])])):(0,l.kq)("",!0)}var T=a(4902),X={data(){return{ready:!1,cartData:{carts:[]},products:[],productsID:"",isLoadingItem:"",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},components:{},methods:{getCart(){this.$http.get("https://vue3-course-api.hexschool.io/v2/api/ming123/cart").then((e=>{this.cartData=e.data.data,this.ready=!0,console.log("getCart()",e)})).catch((e=>{alert(e.data.message)}))},updataCartItem(e){const t={product_id:e.id,qty:e.qty};this.isLoadingItem=e.id,this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/ming123/cart/${e.id}`,{data:t}).then((e=>{console.log("updataCartItem()",e),this.getCart(),this.isLoadingItem="",T.Z.emit("get-cart",(()=>{this.getCart()}))})).catch((e=>{console.dir(e.data.message),alert(e.data.message)}))},removeCartItem(e){this.isLoadingItem=e,this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/ming123/cart/${e}`).then((e=>{console.log("removeCartItem()",e),this.getCart(),T.Z.emit("get-cart",(()=>{this.getCart()})),this.isLoadingItem=""})).catch((e=>{alert(e.data.message)}))},removeAllCartItem(){this.$http.delete("https://vue3-course-api.hexschool.io/v2/api/ming123/carts").then((e=>{console.log("removeAllCartItem()",e),this.getCart(),T.Z.emit("get-cart",(()=>{this.getCart()}))})).catch((e=>{alert(e.data.message)}))},createOrder(){const e=this.form;this.$http.post("https://vue3-course-api.hexschool.io/v2/api/ming123/order",{data:e}).then((e=>{console.log("createOrder()",e),this.$refs.form.resetForm(),this.getCart(),this.form.message="",T.Z.emit("get-cart",(()=>{this.getCart()})),this.$router.push(`/pay/${e.data.orderId}`),console.log("已送出訂單")})).catch((e=>{console.log(e.data.message)}))},isPhone(e){const t=/^(09)[0-9]{8}$/;return!!t.test(e)||"需要正確的電話號碼"}},mounted(){this.getCart()}},ee=a(89);const te=(0,ee.Z)(X,[["render",R]]);var ae=te}}]);
//# sourceMappingURL=158.93ae428c.js.map